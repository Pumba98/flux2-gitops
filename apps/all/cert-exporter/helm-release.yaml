---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: cert-exporter
  namespace: monitoring
spec:
  interval: 5m
  chart:
    spec:
      chart: cert-exporter
      version: 3.3.0
      sourceRef:
        kind: HelmRepository
        name: joe-elliott-charts
        namespace: flux-system
  values:
    certManager:
      image:
        args:
          # - --secrets-annotation-selector=cert-manager.io/certificate-name
          - --secrets-include-glob=*.crt
          - --logtostderr
          - --include-cert-glob=*
          - --include-kubeconfig-glob=*
    service:
      serviceMonitor:
        create: true
    dashboards:
      # Labels to add to all dashboard ConfigMaps
      additionalLabels:
        grafana_dashboard: "1"
      certManagerDashboard:
        create: true
      namespace: monitoring
